<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Merge Sort Visualizer</title>

  <!-- Tailwind CDN (optional, safe on Pages) -->
  <script src="https://cdn.tailwindcss.com" onerror="window.tailwindFailed=true"></script>

  <!-- React 18 UMD builds -->
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin onerror="window.reactFailed=true"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin onerror="window.reactDomFailed=true"></script>

  <!-- Babel standalone so the browser can understand JSX in text/babel scripts -->
  <script src="https://unpkg.com/@babel/standalone/babel.min.js" onerror="window.babelFailed=true"></script>

  <style>
    html,body,#root{height:100%}
    body { 
      background-color: #09090b; 
      color: #fafafa; 
      padding: 1.5rem; 
      font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
      margin: 0;
    }
    
    /* Fallback styles in case Tailwind CDN fails */
    .max-w-3xl { max-width: 48rem; margin: 0 auto; }
    .mx-auto { margin-left: auto; margin-right: auto; }
    .text-2xl { font-size: 1.5rem; line-height: 2rem; }
    .font-bold { font-weight: 700; }
    .mb-4 { margin-bottom: 1rem; }
    .mb-3 { margin-bottom: 0.75rem; }
    .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
    .opacity-80 { opacity: 0.8; }
    .flex { display: flex; }
    .gap-2 { gap: 0.5rem; }
    .gap-1 { gap: 0.25rem; }
    .px-3 { padding-left: 0.75rem; padding-right: 0.75rem; }
    .py-2 { padding-top: 0.5rem; padding-bottom: 0.5rem; }
    .rounded { border-radius: 0.25rem; }
    .bg-blue-600 { background-color: #2563eb; }
    .bg-zinc-700 { background-color: #3f3f46; }
    .bg-emerald-500 { background-color: #10b981; }
    .w-6 { width: 1.5rem; }
    .p-6 { padding: 1.5rem; }
    .bg-zinc-950 { background-color: #09090b; }
    .text-zinc-100 { color: #fafafa; }
    .hover\\:bg-blue-500:hover { background-color: #3b82f6; }
    .hover\\:bg-zinc-600:hover { background-color: #52525b; }
    
    button { 
      cursor: pointer; 
      border: none; 
      transition: background-color 0.2s ease;
      color: inherit;
    }
  </style>
</head>
<body class="bg-zinc-950 text-zinc-100">
  <div id="root" class="p-6"></div>

  <!-- Your app code. Must be type="text/babel" if it contains JSX. -->
  <script type="text/babel">
    const { useState } = React;

    function App(){
      const [arr,setArr] = useState([10,7,8,9,1,5]);

      function mergeSort(a){
        if(a.length <= 1) return a;
        const mid = Math.floor(a.length/2);
        const left = mergeSort(a.slice(0,mid));
        const right = mergeSort(a.slice(mid));
        const out = [];
        let i=0,j=0;
        while(i<left.length || j<right.length){
          if(j>=right.length || (i<left.length && left[i] <= right[j])) out.push(left[i++]);
          else out.push(right[j++]);
        }
        return out;
      }

      return (
        <div className="max-w-3xl mx-auto">
          <h1 className="text-2xl font-bold mb-4">Merge Sort Visualizer</h1>
          <p className="mb-3 text-sm opacity-80">If you can read this, Pages and scripts are loading.</p>
          <div className="flex gap-2 mb-4">
            <button className="px-3 py-2 rounded bg-blue-600 hover:bg-blue-500"
              onClick={()=>setArr(mergeSort([...arr]))}>Sort</button>
            <button className="px-3 py-2 rounded bg-zinc-700 hover:bg-zinc-600"
              onClick={()=>setArr(Array.from({length:10},()=>Math.floor(Math.random()*99)))}>Shuffle</button>
          </div>
          <div className="flex gap-1">
            {arr.map((v,i)=><div key={i} className="bg-emerald-500 w-6" style={{height: 4*v}} title={v}></div>)}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>

  <!-- Fallback script in case CDN resources fail to load -->
  <script>
    // Check if CDN resources loaded properly after a short delay
    setTimeout(function() {
      const hasReact = typeof React !== 'undefined';
      const hasReactDOM = typeof ReactDOM !== 'undefined';
      const hasBabel = typeof Babel !== 'undefined';
      
      if (!hasReact || !hasReactDOM || !hasBabel) {
        console.warn('Some CDN resources failed to load, using fallback implementation');
        
        // Fallback implementation without React/JSX
        class MergeSortVisualizer {
          constructor() {
            this.arr = [10, 7, 8, 9, 1, 5];
            this.render();
          }

          mergeSort(a) {
            if (a.length <= 1) return a;
            const mid = Math.floor(a.length / 2);
            const left = this.mergeSort(a.slice(0, mid));
            const right = this.mergeSort(a.slice(mid));
            const out = [];
            let i = 0, j = 0;
            while (i < left.length || j < right.length) {
              if (j >= right.length || (i < left.length && left[i] <= right[j])) {
                out.push(left[i++]);
              } else {
                out.push(right[j++]);
              }
            }
            return out;
          }

          sortArray() {
            this.arr = this.mergeSort([...this.arr]);
            this.render();
          }

          shuffleArray() {
            this.arr = Array.from({ length: 10 }, () => Math.floor(Math.random() * 99) + 1);
            this.render();
          }

          render() {
            const bars = this.arr.map((v, i) => 
              `<div class="bg-emerald-500 w-6" style="height: ${Math.max(4 * v, 4)}px; display: inline-block; margin-right: 2px; border-radius: 2px;" title="Value: ${v}"></div>`
            ).join('');

            document.getElementById('root').innerHTML = `
              <div class="max-w-3xl mx-auto">
                <h1 class="text-2xl font-bold mb-4">Merge Sort Visualizer</h1>
                <p class="mb-3 text-sm opacity-80" style="color: #10b981;">
                  âœ“ Fallback mode active - working without external dependencies!
                </p>
                <div class="flex gap-2 mb-4">
                  <button id="sortBtn" class="px-3 py-2 rounded bg-blue-600">Sort</button>
                  <button id="shuffleBtn" class="px-3 py-2 rounded bg-zinc-700">Shuffle</button>
                </div>
                <div class="flex gap-1 mb-4">
                  ${bars}
                </div>
                <p class="text-sm opacity-80">
                  Current array: [${this.arr.join(', ')}] (${this.arr.length} elements)
                </p>
              </div>
            `;

            // Add event listeners
            const sortBtn = document.getElementById('sortBtn');
            const shuffleBtn = document.getElementById('shuffleBtn');
            if (sortBtn) sortBtn.onclick = () => this.sortArray();
            if (shuffleBtn) shuffleBtn.onclick = () => this.shuffleArray();
          }
        }

        // Initialize the fallback visualizer
        window.visualizer = new MergeSortVisualizer();
      }
    }, 1000);
  </script>
</body>
</html>
